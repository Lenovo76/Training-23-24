# Task 6.2

# Rotary encoder code to get the number of wheel revolutions done by a navigating robot

## Defining Encoder pins variable

defining pin A and pin B in addition to a counter which counts the number of revolutions done by the robot . it is assigned by long long since the counter can increment in a single loop to 4000. Also, it is volatile since it is accessed within an interrupt function.

```jsx
// Defining encoder pins
#define pinA 2
#define pinB 3

volatile long long counter = 0; // Volatile keyword for the counter variable since it is within an interrupt
```

# Setting pins as INPUT and calling the interrupt function

```jsx
void setup() {
  pinMode(pinA, INPUT_PULLUP);
  pinMode(pinB, INPUT_PULLUP);
  attachInterrupt(digitalPinToInterrupt(pinA), ISR_Encoder_A, CHANGE);
  attachInterrupt(digitalPinToInterrupt(pinB), ISR_Encoder_B, CHANGE);
  Serial.begin(9600); // Moved Serial.begin() to the setup() function
}
```

# Functions for counting clockwise and counter-clockwise revolutions using pin A or B

```jsx
// Interrupt Service Routine for Encoder Pin A
void ISR_Encoder_A() {
  if (digitalRead(pinA) != digitalRead(pinB))
    counter++;
  else
    counter--;
}

// Interrupt Service Routine for Encoder Pin B
void ISR_Encoder_B() {
  if (digitalRead(pinA) == digitalRead(pinB))
    counter++;
  else
    counter--;
}
```

# Printing the number of counts done by the encoder wheel on serial monitor

Long long data type may not be directly supported by the println() function, depending on your Arduino board and version. By casting it to long, you can ensure compatibility and print the value correctly.

```jsx
void loop() {
  // Print the counter value
  Serial.println(long(counter)); //Explicitly casting counter to long
  delay(100); // Added a delay to avoid flooding the serial output
}
```

# Question Part :

We need to design a Software Practical Low Pass Filter (LPF) what is
the proper cutoff frequency (fc) If WALL-E has Specs:

- Encoder has 540 pulse per revolution
- Track has three wheels only one motorized, with 40cm diameter,
(The one that has encoder)
- And Maximum speed of WALL-E 0.5 m/s

### Answer :

First, let's calculate the circumference of the motorized wheel:

Circumference = π * diameter = π * 40 ≈ 125.66 cm

Next, we can calculate the revolutions per second:

Revolutions per second = Maximum speed / Circumference= 0.5 m/s / 125.66 cm

Then, we need to convert cm to meters:

Revolutions per second = 0.5 m/s / 1.2566 m= 0.398 rps = 0.398 Hz

Therefore, WALL-E's motorized wheel completes approximately 0.398 revolutions per second.

To calculate the pulses per second, we multiply the revolutions per second by the number of pulses per revolution:

Pulses per second = Revolutions per second * Pulses per revolution= 0.398 Hz * 540 

Pulses per second ≈ 214.92 pulses/second

Therefore, WALL-E's encoder generates approximately 214.92 pulses per second.